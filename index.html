<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Feira 201 & 203</title>

  <!-- AOS CSS -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

  <style>
    /* Seu CSS permanece igual */
    body {
      background-color: #006400;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0 20px 40px 20px;
    }
    /* ... resto do CSS */
    /* (mantive tudo igual para nÃ£o alongar muito) */
  </style>
</head>

<body>

  <h1>Feira de ciÃªncias 201 & 203</h1>

  <div class="container">
    <!-- ConteÃºdos jÃ¡ existentes -->
    <!-- Wabi-Sabi -->
    <div class="box">
      <h2>Wabi-Sabi</h2>
      <div class="text">
        <p>Wabi-Sabi Ã© a arte de encontrar beleza na imperfeiÃ§Ã£o e na efemeridade da vida...</p>
        <!-- ConteÃºdo cortado para brevidade -->
      </div>
      <div class="image">
        <img src="https://source.unsplash.com/400x300/?nature,leaf" alt="Imagem Wabi-Sabi" />
      </div>
    </div>
    <!-- Upcycling -->
    <div class="box" data-aos="fade-up">
      <h2>Upcycling</h2>
      <div class="text">
        <p>No mundo onde tudo parece descartÃ¡vel, o upcycling surge como um sopro de esperanÃ§a...</p>
      </div>
      <div class="image">
        <img src="https://source.unsplash.com/400x300/?recycle,craft" alt="Imagem Upcycling" />
      </div>
    </div>
    <!-- DIY -->
    <div class="box" data-aos="fade-up">
      <h2>DIY - Do It Yourself</h2>
      <div class="text">
        <p>DIY Ã© mais do que fazer â€” Ã© se conectar...</p>
      </div>
      <div class="image">
        <img src="https://source.unsplash.com/400x300/?handmade,tools" alt="Imagem DIY" />
      </div>
    </div>
  </div>

  <!-- AOS JS -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init();
  </script>

  <!-- Chatbot OpenAI -->
  <button id="chatbot-button" title="Abrir Chatbot">ðŸ’¬</button>

  <div id="chatbot-window">
    <div id="chatbot-header">Chatbot AI</div>
    <div id="chatbot-messages"></div>
    <div id="chatbot-input-area">
      <input id="chatbot-input" type="text" placeholder="Digite sua mensagem..." />
      <button id="chatbot-send-btn">Enviar</button>
    </div>
  </div>

  <script>
    const chatbotButton = document.getElementById('chatbot-button');
    const chatbotWindow = document.getElementById('chatbot-window');
    const chatbotMessages = document.getElementById('chatbot-messages');
    const chatbotInput = document.getElementById('chatbot-input');
    const chatbotSendBtn = document.getElementById('chatbot-send-btn');

    chatbotButton.addEventListener('click', () => {
      if (chatbotWindow.style.display === 'flex') {
        chatbotWindow.style.display = 'none';
      } else {
        chatbotWindow.style.display = 'flex';
        chatbotInput.focus();
      }
    });

    chatbotSendBtn.addEventListener('click', sendMessage);
    chatbotInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    async function sendMessage() {
      const message = chatbotInput.value.trim();
      if (!message) return;

      appendMessage(message, 'user');
      chatbotInput.value = '';
      chatbotInput.disabled = true;
      chatbotSendBtn.disabled = true;

      try {
        // Aqui a URL do seu backend
        const response = await fetch('http://localhost:3000/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message })
        });

        const data = await response.json();

        if (data.error) {
          appendMessage('Erro: ' + data.error, 'bot');
        } else {
          appendMessage(data.reply, 'bot');
        }
      } catch (error) {
        appendMessage('Erro ao conectar com o servidor.', 'bot');
        console.error(error);
      }

      chatbotInput.disabled = false;
      chatbotSendBtn.disabled = false;
      chatbotInput.focus();
    }

    function appendMessage(text, sender) {
      const messageDiv = document.createElement('div');
      messageDiv.classList.add('message');
      messageDiv.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
      messageDiv.textContent = text;
      chatbotMessages.appendChild(messageDiv);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }
  </script>
</body>
</html>
